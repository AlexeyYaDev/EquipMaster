<Window x:Class="EquipMaster.Views.Assignment.AssignmentHistoryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:EquipMaster.ViewModels"
        Title="История перемещений"
        Height="500" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Window.DataContext>
        <vm:AssignmentHistoryViewModel/>
    </Window.DataContext>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Фильтры -->
            <RowDefinition Height="*"/>
            <!-- Таблица -->
            <RowDefinition Height="Auto"/>
            <!-- Кнопка Закрыть -->
        </Grid.RowDefinitions>

        <!-- 🔍 Фильтры -->
        <!-- 🔍 Фильтры -->
        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                <Label Content="Поиск:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox Width="300"
                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                 ToolTip="Поиск по пользователю, серийному номеру, модели, типу или заметкам"/>
                <Button Content="Очистить фильтры"
                Margin="10,0,0,0"
                Padding="6,3"
                Click="ClearFilters_Click"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                <Label Content="Выдано с:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <DatePicker SelectedDate="{Binding AssignedFrom}" Width="120"/>
                <Label Content="по:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                <DatePicker SelectedDate="{Binding AssignedTo}" Width="120"/>

                <Label Content="   Возвращено с:" VerticalAlignment="Center" Margin="20,0,5,0"/>
                <DatePicker SelectedDate="{Binding ReturnedFrom}" Width="120"/>
                <Label Content="по:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                <DatePicker SelectedDate="{Binding ReturnedTo}" Width="120"/>
            </StackPanel>
        </StackPanel>


        <!-- 🗄 Таблица истории -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding AssignmentHistoryView}"
                  SelectedItem="{Binding SelectedItem}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  Margin="0,0,0,40">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Пользователь" Binding="{Binding UserName}" Width="2*"/>
                <DataGridTextColumn Header="Серийный номер" Binding="{Binding SerialNumber}" Width="1.5*"/>
                <DataGridTextColumn Header="Оборудование" Binding="{Binding EquipmentModel}" Width="2*"/>
                <DataGridTextColumn Header="Тип" Binding="{Binding EquipmentType}" Width="*"/>
                <DataGridTextColumn Header="Выдано" Binding="{Binding AssignedAt, StringFormat={}{0:dd.MM.yyyy}}" Width="*"/>
                <DataGridTextColumn Header="Возвращено" Binding="{Binding ReturnedAt, StringFormat={}{0:dd.MM.yyyy}}" Width="*"/>
                <DataGridTextColumn Header="Заметка (при выдаче)" Binding="{Binding AssignmentNotes}" Width="2*"/>
                <DataGridTextColumn Header="Заметка (при возврате)" Binding="{Binding ReturnNotes}" Width="2*"/>
            </DataGrid.Columns>
        </DataGrid>

        <Button Grid.Row="2"
                Content="Закрыть"
                Width="100" Height="30"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Click="Close_Click"/>
    </Grid>
</Window>
