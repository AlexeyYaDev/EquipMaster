<!-- ReportViewerWindow.xaml -->
<Window x:Class="EquipMaster.Views.ReportViewerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Просмотр отчёта"
        Height="600" Width="900"
        WindowStartupLocation="CenterOwner"
        Background="#f9f9f9"
        MinWidth="600" MinHeight="400">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Универсальный фильтр по дате -->
            <RowDefinition Height="Auto"/>
            <!-- Фильтры для выдач -->
            <RowDefinition Height="Auto"/>
            <!-- Фильтры для списка пользователей -->
            <RowDefinition Height="Auto"/>
            <!-- Фильтры для состояния оборудования -->
            <RowDefinition Height="Auto"/>
            <!-- Фильтры для истории обслуживания -->
            <RowDefinition Height="*"/>
            <!-- Таблица -->
            <RowDefinition Height="Auto"/>
            <!-- Кнопки -->
        </Grid.RowDefinitions>

        <!-- Универсальный фильтр по дате + кнопки Фильтровать и Очистить -->
        <StackPanel Orientation="Horizontal" Grid.Row="0" VerticalAlignment="Center" Margin="0,0,0,10">
            <TextBlock Text="Период:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <DatePicker x:Name="FromDatePicker" Width="130" Margin="0,0,10,0"/>
            <TextBlock Text="до" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <DatePicker x:Name="ToDatePicker" Width="130" Margin="0,0,15,0"/>
            <Button Content="Фильтровать" Width="90" Padding="8,3" Click="ApplyFilter_Click" Margin="0,0,10,0" Cursor="Hand"/>
            <Button Content="Очистить фильтр" Width="120" Padding="8,3" Click="ClearFilter_Click" Cursor="Hand"/>
        </StackPanel>

        <!-- Фильтры для отчёта по выдачам -->
        <StackPanel Orientation="Horizontal" Grid.Row="1" VerticalAlignment="Center" Margin="0,0,0,10"
                    Visibility="Collapsed" x:Name="AssignmentFiltersPanel">
            <TextBlock Text="Пользователь:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="UserComboBox" Width="180" Margin="0,0,10,0" DisplayMemberPath="FullName"
                      IsEditable="True" StaysOpenOnEdit="True" IsTextSearchEnabled="True"/>
            <TextBlock Text="Оборудование:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="EquipmentComboBox" Width="180" Margin="0,0,10,0" DisplayMemberPath="SerialNumber"
                      IsEditable="True" StaysOpenOnEdit="True" IsTextSearchEnabled="True"/>
            <TextBlock Text="Дата возврата:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="ReturnedFilterComboBox" Width="120" Margin="0,0,10,0" SelectedIndex="0">
                <ComboBoxItem>Все</ComboBoxItem>
                <ComboBoxItem>Только возвращённые</ComboBoxItem>
                <ComboBoxItem>Только не возвращённые</ComboBoxItem>
            </ComboBox>
        </StackPanel>

        <!-- Фильтры для списка пользователей -->
        <StackPanel Orientation="Horizontal" Grid.Row="2" VerticalAlignment="Center" Margin="0,0,0,10"
                    Visibility="Collapsed" x:Name="UsersFiltersPanel">
            <TextBlock Text="Статус пользователя:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="UserStatusComboBox" Width="160" Margin="0,0,10,0" SelectedIndex="0">
                <ComboBoxItem>Все</ComboBoxItem>
                <ComboBoxItem>Активные</ComboBoxItem>
                <ComboBoxItem>Заблокированные</ComboBoxItem>
            </ComboBox>
        </StackPanel>

        <!-- Фильтры для состояния оборудования -->
        <StackPanel Orientation="Horizontal" Grid.Row="3" VerticalAlignment="Center" Margin="0,0,0,10"
                    Visibility="Collapsed" x:Name="EquipmentStatusFiltersPanel">
            <TextBlock Text="Статус:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="EquipmentStatusComboBox" Width="150" Margin="0,0,10,0" SelectedIndex="0">
                <ComboBoxItem>Все</ComboBoxItem>
                <ComboBoxItem>В использовании</ComboBoxItem>
                <ComboBoxItem>В резерве</ComboBoxItem>
                <ComboBoxItem>На обслуживании</ComboBoxItem>
                <ComboBoxItem>Списано</ComboBoxItem>
            </ComboBox>
            <TextBlock Text="Тип:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="EquipmentTypeComboBox" Width="150" Margin="0,0,10,0" DisplayMemberPath="Name"/>
            <TextBlock Text="Последнее ТО:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="LastMaintenanceFilterComboBox" Width="120" Margin="0,0,10,0" SelectedIndex="0">
                <ComboBoxItem>Все</ComboBoxItem>
                <ComboBoxItem>Есть дата</ComboBoxItem>
                <ComboBoxItem>Нет даты</ComboBoxItem>
            </ComboBox>
        </StackPanel>

        <!-- Фильтры для истории обслуживания -->
        <StackPanel Orientation="Horizontal" Grid.Row="4" VerticalAlignment="Center" Margin="0,0,0,10"
                    Visibility="Collapsed" x:Name="MaintenanceHistoryFiltersPanel">
            <TextBlock Text="Тип оборудования:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="MaintenanceEquipmentTypeComboBox" Width="150" Margin="0,0,10,0" DisplayMemberPath="Name"/>
            <TextBlock Text="Исполнитель:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="PerformedByComboBox" Width="150" Margin="0,0,10,0" IsEditable="True"/>
            <TextBlock Text="Результат:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="ResultComboBox" Width="150" Margin="0,0,10,0" IsEditable="True"/>
        </StackPanel>

        <!-- Таблица отчёта -->
        <DataGrid x:Name="ReportDataGrid" Grid.Row="5"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  ColumnWidth="Auto"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Auto"
                  SelectionMode="Extended"
                  AlternatingRowBackground="#EEE"
                  GridLinesVisibility="Horizontal"
                  RowHeaderWidth="0"
                  FontSize="14"
                  HeadersVisibility="Column"
                  BorderThickness="1" BorderBrush="#CCC"/>

        <!-- Кнопки экспорта и закрытия -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Экспорт в CSV" Width="130" Padding="8,5" Margin="0,0,10,0"
                    Click="ExportToCsv_Click" Cursor="Hand"/>
            <Button Content="Закрыть" Width="90" Padding="8,5" Click="Close_Click" Cursor="Hand"/>
        </StackPanel>
    </Grid>
</Window>
